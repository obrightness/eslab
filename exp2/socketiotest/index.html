<!doctype html>

<html>
  <head>
    <title>ES Lab HW2</title>
   
    <h1>Team 10</h1>
    
    <table id="tb">
      <tr>
	<th>Accelerometer</th>
	<th>Map </th>
	<th>Photo </th>	    
      </tr>
      <tr>
	<td> <div id="Ac"> </div> </td> 
	<td> <div id="mp"> </div></td>
        <td> <img id="box" src="" ></img>  </td>
      </tr>
    </table>

    <style>
        h1{
	  margin:30px;
	  text-align: center;
	}
	table{
	  border: 2;
	  border-style:double;
	  font-family: arial;
	  font-size: 14px;
	  margin-left: auto;
	  margin-right: auto;
	}
	th{
	  text-align: center;
	  background-color: #FBF9D0;
	}
	.box{
	  height: 500px;
	  width: 250px;
	}
	.box img{
	  position: absolute;
	  top:0;
	  left:0;
	  right: 0;
	  bottom: 0;
	  margin: auto;
	  height: 50%;
	  width: 50%; 
	}
	
    </style>
  </head>
  <body>
    <script src="d3" charset="utf-8"></script>
    <script src="socket"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.js"></script>
   

    <script>
	
    var socket = io.connect();
        socket.on('newphoto', function(){
	socket.emit('photo');
	

	socket.on('image', function(img){
		var imgObj = new Image();
		imgObj.src = img.content;
	console.log(img);
//	console.log(imgObj);		 
		//var canvas = document.createElement("img");
		//canvas.width = 250;
		//canvas.height = 500;
		//canvas.src = img.content;

		//var ctx = canvas.getContext('2d');
		//ctx.drawImage(imgObj, 0 ,0 );
		document.getElementById('box').src = img.content;
		//console.log(canvas);
		console.log(document.getElementById('box'));
		
//console.log(ctx);

	//	var dataURL = canvas.toDataURL('image/jpg');
	//	dataURL.replace(/^data:image\/(png|jpg);base64,/, "");

//為何沒有圖但是有canvas~~~~~~		
/*
var x = document.getElementById('box');
var y = x.cells;
//var Img = document.createElement('img');
//Img.src = img.content ;
y.appendChild(imgObj);
*/

	});
    });

    socket.on('update', function(data){

		    document.getElementById('mp').innerHTML = "";
		    line_data = data.data;
		    var svg = d3.select('#mp')
		    .append('svg')
		    .attr({  'width': 250, 'height': 500  });

		    var line = d3.svg.line()
		    .x(function(d){ return d.x; })
		    .y(function(d){ return d.y; })
		    .interpolate("linear-closed");	

		    svg.append('path')
		    .attr({
			    'd': line(line_data),
			    //'y': 0,
			    'stroke': '#000',
			    'stroke-width': '2px',
			    'fill': 'none'  
		    });
	});
    socket.on('acc', function(data_acc){

		    document.getElementById('Ac').innerHTML = "";
		    var point = data_acc.data_acc;
		    var svg = d3.select('#Ac')
		    .append('svg')
		    .attr({ 'width':250, 'height': 500 });

	   	    var line = d3.svg.line()
		    .x(function(d){ return d.x })
		    .y(function(d){ return d.y })
		    .interpolate("linear-closed");

	 	    svg.append('path')
		    .attr({
			'd': line(point),
			'stroke': '#000',
			'stroke-width': '2px',
			'fill': 'none'
		    });

    });

    </script>
  </body>
</html>

